//created on: 07-dic-2016
package rules

import tercerhombre.personaje.Personaje;
import tercerhombre.propiedades.*;
import tercerhombre.io.Buffer;


// Revisar el orden de las reglas

rule "kurtz y  martins van casa lime" agenda-group "g2"

    when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CAFEMOZART )
        kurtz : Personaje( nombre == Personaje.kurtz, ubicacion == Ubicacion.CAFEMOZART )
    then
    
    	insert(Personaje.nuevo().
    	setNombre(Personaje.anna).
    	setGenero(Genero.MUJER).
    	setActividad(ActividadLegal.ACTRIZ).
    	setEstadoSalud(EstadoSalud.VIVO).
    	setNacionalidad(null).
    	setUbicacion(null));
    	
    	//Insertamos a Winkel
    	
    	insert(Personaje.nuevo().
    	setNombre(Personaje.winkel).
    	setGenero(Genero.HOMBRE).
    	setActividad(ActividadLegal.MEDICO).
    	setEstadoSalud(EstadoSalud.VIVO).
    	setNacionalidad(null).
    	setUbicacion(null));
    	
    	modify(winkel){
    	 getConoce_a().add(lime);
    	};	

		modify(winkel){
    		getAmigo_de().add(lime);
    	};	

		modify(winkel){
    		getConoce_a().add(kurtz);
    	};	

		modify(lime){
    		getAmigo_de().add(winkel);
    	};	

		modify(lime){
    		getConoce_a().add(winkel);
    	};
	
		modify(kurtz){
    		getConoce_a().add(winkel);
    	};	
    	
    	insert(Personaje.nuevo().
    	setNombre(Personaje.popescu).
    	setGenero(Genero.HOMBRE).
    	setActividad(Actividad.desconocida).
    	setEstadoSalud(EstadoSalud.VIVO).
    	setNacionalidad(Nacionalidad.RUMANO).
    	setUbicacion(null));

modify(popescu){
    		getConoce_a().add(lime);
    	};	

modify(popescu){
    		getAmigo_de().add(lime);
    	};	

modify(popescu){
    		getConoce_a().add(kurtz);
    	};

modify(popescu){
    		getAmigo_de().add(kurtz);
    	};	

modify(lime){
    		getAmigo_de().add(popescu);
    	};	

modify(lime){
    		getConoce_a().add(popescu);
    	};
	
modify(kurtz){
    		getConoce_a().add(popescu);
    	};

modify(kurtz){
    		getAmigo_de().add(popescu);
    	};
    
        modify(kurtz){
		setUbicacion(Ubicacion.CASALIME);
		};
		modify(martins){
		setUbicacion(Ubicacion.CASALIME);
		};
		modify(martins){
    		getBusca_a().add(anna);
    	};
    	modify(karl){
    	getConoce_a().add(kurtz);
    	}
		

end

rule "insertar Anna" agenda-group "g2"

   when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CASALIME )
        kurtz : Personaje( nombre == Personaje.kurtz, ubicacion == Ubicacion.CASALIME )
        anna : Personaje( nombre == Personaje.anna )
        lime : Personaje( nombre == Personaje.lime )
    then
      
    	
    	modify(anna){
				setUbicacion(Ubicacion.CASANOVACLUB);
			};

		modify(anna){
	    		getConoce_a().add(lime);
	    	};
		modify(kurtz){
	    		getConoce_a().add(anna);
	    	};
		modify(lime){
	    		getConoce_a().add(anna);
	    	};
	    modify(martins){
	    		getBusca_a().add(anna);  //TODO hay que quitarlo despues?
	    }

end
rule "visita a anna" agenda-group "g2"
	when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CASALIME )
    	anna : Personaje( nombre == Personaje.anna , ubicacion == Ubicacion.CASANOVACLUB)
    then
    
     	modify(martins){
	    setUbicacion(Ubicacion.CASANOVACLUB);
	    };
	    
	     modify(martins){
	    		getConoce_a().add(anna);
	    };
	    
	    modify(anna){
	    		getConoce_a().add(martins);
	    };
	    
	    modify(anna){
    		getQuiere_a().add(lime);
    	};
    	
	    
end

 rule "vuelta a casa Lime" agenda-group "g2"
	when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CASANOVACLUB )
        anna : Personaje( nombre == Personaje.anna , ubicacion == Ubicacion.CASANOVACLUB)
    then 
    	modify(martins){
	    setUbicacion(Ubicacion.CASALIME);
	    };
	    modify(anna){
	    setUbicacion(Ubicacion.CASALIME);
	    };
	    
    	
    
end

rule "martins y anna van a casa de anna" agenda-group "g2"
	when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CASALIME )
      	anna : Personaje( nombre == Personaje.anna , ubicacion == Ubicacion.CASALIME)
    then
end    

rule "insertar Winkel" agenda-group "g2"  // para inseratar a Winkel primero martins tiene que ir 

   when
    	martins : Personaje( nombre == Personaje.martins, ubicacion == Ubicacion.CASAWINKEL )
        winkel : Personaje( nombre == Personaje.winkel )
    then
    
    	modify(winkel){
    	 getConoce_a().add(lime);
    	};	

		modify(winkel){
    		getAmigo_de().add(lime);
    	};	

		modify(winkel){
    		getConoce_a().add(kurtz);
    	};	

		modify(lime){
    		getAmigo_de().add(winkel);
    	};	

		modify(lime){
    		getConoce_a().add(winkel);
    	};
	
		modify(kurtz){
    		getConoce_a().add(winkel);
    	};	


end